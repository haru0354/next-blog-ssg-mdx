# 概要

Next.jsでSSGでのブログを作成することができます。

- SEOを意識したサイト構造
  - 画像をwebpに変換し圧縮
- 作成時に変更する箇所
- カテゴリの作成手順
  - カテゴリの補足
- 記事の作成手順
  - 記事の補足
- 追加できるメニュー
- デザインの変更
- 今後追加する項目

Markdownファイルへの記述により記事やカテゴリを追加していきます。

デザインはtailwindを使用しています。
コンテンツ部分(MDXファイルに記載部分)のデザインは「globals.css」に記載し適用がされています。

今後、cssは追加予定ですが現状で使用したい人は個別で追加して頂ければと思います。

現状の項目が少ないのでそのままcssを使用しています。
項目を増やすのならsassを適用するのがネスト化の手間が省けていいかと思います。

## 使用技術

- TypeScript
- React / Next.js 14(SSG)
- Tailwind CSS

その他のライブラリ等の一部

- @next/mdx
- react-markdown
- gray-matter
- rehype-slug
- remark-toc
- sharp

「MDXに対応」「目次の作成」「画像の圧縮」の為に、これらのライブラリなどの導入がされています。


## SEOを意識したサイト構造

SEOを気にする人用にデフォルトのサイト構造を紹介します。

現状、見出しタグは重視されないとされています。
但し、簡単にできることは全て行うのがSEOの基本かと思います。

h1見出しタグが複数あったり、コンテンツがh2タグしかなかったりと、サイト構造がしっかりしていないのを見ると、個人的にはすごく気になります。

- TOPページ
  - logoがh1タグとなっています。
  - カテゴリタイトルはh3タグとなります。 
  - 記事タイトルはh3タグとなります。 

- 記事ページ
  - logoは見出しタグは付きません。
  - 記事タイトルがh1タグとなります。

- カテゴリページ
  - 関連記事はh2タグとなります。
  - 関連記事内の各個別ページのタイトルはh3タグとなります。

記事ページのタイトルは「記載した記事タイトル | サイトタイトル」になります。
カテゴリページのタイトルは「記載したカテゴリタイトル | サイトタイトル」になります。

TOPページはサイト名がH1で各記事ページは記事タイトルがH1の最近の主流？の構造になっています。

## 画像をwebpに変換し圧縮

publicフォルダに画像を配置すると圧縮と変換がされた画像が配置されます。

「npm run dev」と[npm run build]の実行時に2種類の画像ファイルに圧縮と変換が行われます。

1. image_webpフォルダ：80%の品質で圧縮、webpに変換
2. thumbnail_webpフォルダ：80%の品質で圧縮、width：300px、webpに変換

記事のアイキャッチには「image_webpフォルダ」の画像が配置されます。
TOPページ、関連記事、サイドメニューには「thumbnail_webpフォルダ」の画像が配置されます。

変換をした画像は「scriptsフォルダ」の「ConvertedFileNameList.json」にリスト化されていきます。
再度、実行時に照らし合わせて、未変換のファイルのみ変換と圧縮がされるようになっています。

現状、「thumbnail_webpフォルダ」の画像はサイトのテンプレートの中で280pxから350pxの画像が使われています。
そのため、完璧な画像が配置できている訳ではありません。

そのため、サイト全体のデザインを調整するか考慮中です。
詳しくはscriptsフォルダにある「ConvertToWebp.js」をご覧ください。

## 作成時に変更する箇所

このブログを利用する際にサイトタイトル等、変更する箇所が数点あります。

- 画像
  - ロゴ画像(logo.png)
  - ファビコン(favicon.ico)
- 環境変数(.env.local)
- robot.txt(変更箇所)

ロゴ画像(logo.png)やファビコン(favicon.ico)はカッコ内の名称で画像が設置されています。

そのため、publicフォルダに画像を配置し、「npm run image」コマンドを実行してください。
webpに圧縮された画像が配置されるようになっています。

基本的にその他の変更箇所は「.env.local」に用意されている環境変数の各項目を変更することで反映がされます。

但し、「robot.txt」に関してはそのままサイトのURLを変更するようにしてださい。

## カテゴリの作成手順

現状でこのブログは最大で３階層までとなっており、「親カテゴリ」と「子カテゴリ」の２種類が作成可能となっています。

TOPページ
  |_  親カテゴリ
 　 |_ 子カテゴリ
 　　 |_ 記事ページ

TOPページ
  |_  親カテゴリ
 　　 |_ 記事ページ

### 親カテゴリの作成手順

1. mdFile ディレクトリの「categorySample」をコピー
2. 「mdFile > category」ディレクトリとへコピーしたサンプルファイルを入れる。
3. ファイル名を変更する(slugになる)。
4. 各項目を変更をする。
5. 「mdFile > article」ディレクトリにカテゴリのファイル名でフォルダを作成する

articleディレクトに作成したフォルダ内に個別記事を入れることで、その記事はカテゴリに属することになります。

### 子カテゴリの作成手順

1. mdFile ディレクトリの「categorySample」をコピー
2. mdFile > category ディレクトリに親カテゴリの.mdxを省いた名称でフォルダを作成
3. 作成したディレクトリにコピーしたサンプルファイルを入れる。
3. ファイル名を変更する(slugになる)。
4. 各項目を変更をする。
5. 「mdFile > article」ディレクトリの親カテゴリフォルダ内に.mdxを省いた子カテゴリの名称でフォルダを作成

articleディレクトに作成したフォルダ内に個別記事を入れることで、その記事はカテゴリに属することになります。

### カテゴリの補足

カテゴリページは初期状態で「リスト表示」となり、コンテンツを記載すればコンテンツの表示もされるように作成しています。。

上記仕様の理由としてはユーザービリティーとSEOを考慮しています。

サイト構造を考えても上記仕様が適していると思います。

SEO的には簡単に説明するとカテゴリページは内部リンクが集まりやすく、サイト構造の部分も含めてページを作りこむのに適しているからです。

categoryName: カテゴリ名を記載
title: カテゴリのタイトル(記事タイトルと同じ)

## 記事の作成手順

1. mdFile ディレクトリの「articleSample」をコピー
2. mdFile > article ディレクトリの記事を含めたいカテゴリフォルダ内にコピーしたサンプルファイルを入れる。
3. ファイル名を変更する(slugになる)。
4. 各項目を変更をする。

### 固定記事(どのカテゴリにも属さない)の作成方法

どのカテゴリにも属さない固定記事に関しては、「mdFile > article」ディレクトリ内に「articleSample」ファイルを入れてください。

この固定記事は「TOPページ ＞　固定ページ」となります。

まだ、どのカテゴリにも属さず、新着記事の項目などにも表示がされないようになっています。

主に、「WEBサイトの運営全般の内容」や「CTA目的とした記事」や「どのカテゴリにも属さない記事」などを想定しています。

## 追加できるメニュー

記載をすることで様々なメニューを追加できるようになっています。

- グローバルメニュー(globalMenu.md)
- サイドバーのおすすめの記事(recommendArticle.md)
- サイドバーのリンク(参考文献・参考サイト)(link.md)

それぞれのファイルはmdFileディレクトリのmenuディレクトリの中にあります。
各ファイルの１つ目を記載すると、各メニューが表示されるようになります。

## デザインの変更

- パターン2への変更(ブロック型)
  - SideMenu.tsxの「bg-white」を外す
  - コンポーネント > sideMenu 内のコンポーネントをSideCategory2とSideNewArticle2に変更。
  - (blog) > [category_slug]の１つ目のdivタグに「border border-gray-200」を追加
  - (blog) > [category_slug] > [article_slug]の１つ目のdivタグに「border border-gray-200」を追加


- カテゴリの関連記事の変更
  - (blog) > [category_slug] 最下部の(CategoryInArticlesList)コンポーネントを変更

1. 画像2枚が横並び(CategoryInArticlesList2Images)
2. 左に画像、右にタイトルと説明文(CategoryInArticlesList)


(blog) > [category_slug]

### イメージカラーの変更

TailwindCSSを使用しています。

「tailwind.config.ts」のcolorsのmainの部分でイメージカラーを設定しています。
初期状態はgrayが当たっています。

この部分にカラーを追加して、「bg-main-gray」を検索して、新たに作成したイメージカラーの「bg-main-●●」で置換をして頂ければ、一括で変更がされます。

また、面倒だというのであれば、grayの部分の名前は変えずにスタイルを変える方法でも可能です。


## 個人的メモ

- TOPページをコンテンツ表示と現状の表示と選択できるようにする。
- TOPページ用のコンポーネント（大カテゴリと子カテゴリを表示させる）を作成
- TOPページ用のコンポーネント（おすすめ記事6個）を作成
- TOPページ用のコンポーネント（おすすめ記事 ２カラムの左画像と右テキスト）を作成
- TOPページ用のコンポーネント（おすすめ記事 上段大画像2個 / 下段小画像3個）を作成
- サイドバーの新着記事を子カテゴリページでは親カテゴリの新着記事を表示させる
- 検索バーの追加
- デザインコンポーネントの追加